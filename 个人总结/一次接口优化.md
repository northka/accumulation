#一次接口优化
###需求说明
获得多个榜单，然后获得榜单内的所有主播，然后去查主播所有的信息
###未优化前
先得到榜单，然后逐一得到榜单主播，然后逐一获得主播的百科，房间信息，最后输出到前端页面，第一次接口速度
![image](https://raw.githubusercontent.com/northka/accumulation/master/img/1483962656(1).jpg)
###分析接口慢的原因
由于要多次请求mysql数据库，每一次大概30ms左右返回，这样多次阻塞请求，请求速度慢很多
###优化第一步
很明显是远程调用次数太多且都是阻塞的所以就把无关联的sql请求同时请求
<br/>
第一次请求获取所有的榜单
<br/>
第二次请求同时发榜单数量的榜单信息请求
<br/>
第三次请求榜单内所有主播的请求
###优化效果
![image](https://raw.githubusercontent.com/northka/accumulation/master/img/1484018347(1).jpg)
同时发请求快了将近10倍，这是异步带来的优化
###优化第二步
现在300~400ms的接口是因为要分多层级发请求，而一次sql请求大概耗时在30ms，其中大部分时间应该是传输耗时，有由于表都是小表，所以准备连表查询
